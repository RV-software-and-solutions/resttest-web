version: 0.2
env:
  variables:
    #VERSION: "1.0"
    #IMAGE_REPO_NAME: "payment"
    AWS_ACCOUNT_ID: "877859816718"
    AWS_DEFAULT_REGION: "eu-central-1"

phases:
  install:
    commands:
      #- /usr/local/bin/node-install.sh --channel STS

  pre_build:
    commands:
      - curl -sS -o - https://dl-ssl.google.com/linux/linux_signing_key.pub | apt-key add -
      - echo "deb http://dl.google.com/linux/chrome/deb/ stable main" >> /etc/apt/sources.list.d/google-chrome.list
      - apt-get -y update
      - apt-get -y install google-chrome-stable
      - npm install
      - export CHROME_BIN=~/.local/share/flatpak/app/com.google.Chrome/current/active/export/bin/com.google.Chrome
      - npm run 'test:prod'
      - npm run lint
  
  build:
    commands:
      - echo "Running unit-test.sh"
      - npm run build --prod
      
  post_build: 
    commands:
      - echo "Integration test complited"

